//>>built
require({cache:{"url:davinci/ve/input/templates/MultiFieldMultiLineTableRowSmartInput.html":'\x3ctr\x3e\n\t\x3ctd class\x3d"MultiFieldSmartInput_SmartInput_label" \x3e\n\t\t{label}\n\t\x3c/td\x3e\n\t\x3ctd\x3e\n\t\t\x3cdiv class\x3d"MultiFieldSmartInput_SmartInput_value"\x3e\n\t\t\t\x3cinput type\x3d"text" name\x3d"{textboxId}"  data-dojo-type\x3d"dijit/form/SimpleTextarea" data-dojo-props\x3d"trim:true" class\x3d"smartInputTextAreaMulti" value\x3d"{textboxValue}" id\x3d"{textboxId}"\x3e\n\t    \x3c/div\x3e\n    \x3c/td\x3e\n    \x3ctd class\x3d"MultiFieldSmartInput_SmartInput_checkbox"\x3e\n    \t\x3cdiv id\x3d"{checkboxDivId}"\x3e\n    \t\t\x3cinput id\x3d"{checkboxId}" name\x3d"{checkboxId}" data-dojo-type\x3d"dijit/form/CheckBox" {checked} /\x3e\n\t\t\t\x3clabel for\x3d"{checkboxId}"\x3ehtml\x3c/label\x3e\n    \t\x3c/div\x3e\n\t\x3c/td\x3e\n\x3c/tr\x3e\n\n',
"url:davinci/ve/input/templates/MultiFieldTableRowSmartInput.html":'\x3ctr\x3e\n\t\x3ctd class\x3d"MultiFieldSmartInput_SmartInput_label" \x3e\n\t\t{label}\n\t\x3c/td\x3e\n\t\x3ctd\x3e\n\t\t\x3cdiv class\x3d"MultiFieldSmartInput_SmartInput_value"\x3e\n\t\t\t\x3cinput type\x3d"text" name\x3d"{textboxId}"  data-dojo-type\x3d"{textboxType}" data-dojo-props\x3d"trim:true" value\x3d"{textboxValue}" id\x3d"{textboxId}"\x3e\n\t    \x3c/div\x3e\n    \x3c/td\x3e\n    \x3ctd class\x3d"MultiFieldSmartInput_SmartInput_checkbox"\x3e\n    \t\x3cdiv id\x3d"{checkboxDivId}"\x3e\n    \t\t\x3cinput id\x3d"{checkboxId}" name\x3d"{checkboxId}" data-dojo-type\x3d"dijit/form/CheckBox" {checked} /\x3e\n\t\t\t\x3clabel for\x3d"{checkboxId}"\x3ehtml\x3c/label\x3e\n    \t\x3c/div\x3e\n\t\x3c/td\x3e\n\x3c/tr\x3e\n\n',
"url:davinci/ve/input/templates/MultiFieldSmartInput.html":'\x3cdiv id\x3d"iedResizeDiv"  class\x3d"iedResizeDiv"\x3e \n\x3cdiv dojoType\x3d"dijit.layout.ContentPane" class\x3d"MultiFieldSmartInput_SmartInput_CP"\x3e\n  \x3ctable id\x3d"davinci.ve.input.MultiFieldSmartInput_table"\x3e \n    \x3ctbody\x3e \n      {tableContent}\n    \x3c/tbody\x3e \n  \x3c/table\x3e \n\x3c/div\x3e   \n  \x3cdiv id\x3d"smartInputSim" class\x3d"smartInputSim" style\x3d"display:none;"\x3e\x3c/div\x3e\n  \x3cdiv id\x3d"iedResizeHandle" dojoType\x3d"dojox.layout.ResizeHandle" targetId\x3d"iedResizeDiv" constrainMin\x3d"true" maxWidth\x3d"200" maxHeight\x3d"600" minWidth\x3d"240" minHeight\x3d"60"  activeResize\x3d"true" intermediateChanges\x3d"true"\x3e\x3c/div\x3e\n\x3c/div\x3e\n\x3c/td\x3e\n\x3c/tr\x3e\n\x3c/table\x3e\n\x3cdiv id\x3d"davinci.ve.input.SmartInput_div"  class\x3d"davinciVeInputSmartInputDiv"\x3e \n  \x3cdiv id\x3d"davinci.ve.input.SmartInput_radio_div" class\x3d"smartInputRadioDiv"\x3e \n   \x3cdiv class\x3d"smartInputHelpDiv"\x3e \n      \x3cspan id\x3d"davinci.ve.input.SmartInput_img_help"  title\x3d"Help" class\x3d"inlineEditHelp"\x3e \x3c/span\x3e\n      \x3cspan class\x3d"smartInputSpacerSpan"\x3e\n      \x3cbutton id\x3d"davinci.ve.input.SmartInput_ok"  dojoType\x3d"dijit.form.Button" type\x3d"submit" class\x3d"inlineEditHelpOk"\x3e{buttonOk}\x3c/button\x3e \x3cbutton id\x3ddavinci.ve.input.SmartInput_cancel dojoType\x3d"dijit.form.Button" class\x3d"inlineEditHelpCancel"\x3e{buttonCancel}\x3c/button\x3e  \n      \x3c/span\x3e   \n    \x3c/div\x3e \n    \x3cdiv id\x3d"davinci.ve.input.SmartInput_div_help" style\x3d"display:none;" class\x3d"smartInputHelpTextDiv"\x3e \n      \x3cdiv dojoType\x3d"dijit.layout.ContentPane" class\x3d"smartInputHelpTextDivContentPane" style\x3d"padding:0;"\x3e{helpText}\x3c/div\x3e \n      \x3cdiv style\x3d"text-align: left; padding:0; height:2px;"\x3e\x3c/div\x3e \n    \x3c/div\x3e \n  \x3c/div\x3e \n\x3c/div\x3e \n\n'}});
define("davinci/ve/input/MultiFieldSmartInput","dojo/_base/declare davinci/Runtime davinci/ve/input/SmartInput davinci/ve/widget davinci/ve/commands/ModifyCommand dojox/html/entities dijit/form/DateTextBox dijit/form/TimeTextBox dojo/i18n!dijit/nls/common dojo/text!./templates/MultiFieldSmartInput.html dojo/text!./templates/MultiFieldTableRowSmartInput.html dojo/text!./templates/MultiFieldMultiLineTableRowSmartInput.html dijit/Tooltip davinci/css!./templates/MultiFieldSmartInput.css".split(" "),function(l,
m,n,p,q,h,r,s,k,t,u,v,w){return l(n,{property:[{property:"placeholder",multiLine:!1},{property:"value",multiLine:!1}],displayOnCreate:"true",delimiter:", ",multiLine:"true",supportsHTML:"false",_substitutedMainTemplate:null,destroyTooltips:function(){this.property.forEach(function(a){dijit.byId("MultiFieldSmartInput_SmartInput_checkbox_"+(a.property||a.child.property)+"_tooltip").destroyRecursive()}.bind(this))},_getEditor:function(){return m.currentEditor},_getContext:function(){var a=this._getEditor();
return a&&(a.getContext&&a.getContext()||a.context)},getHelpText:function(){var a="";this.helpText?a=this.helpText:this.property.forEach(function(b){var c=b.property||b.child.property,d=this._widget.metadata.property[c]?this._widget.metadata.property[c].description:null;b.helpText&&(d=b.helpText);d&&(a=a+"\x3ci\x3e"+this.getTitle(c)+":\x3c/i\x3e "+h.encode(d)+"\x3cbr\x3e")}.bind(this));1>a.length&&(a="The toolkit provider has not supplied help for this widget, please consult your provider.");return a},
getTitle:function(a){return a},getPropertyObject:function(a){for(var b=0;b<this.property.length;b++){if(this.property[b].property&&this.property[b].property==a)return this.property[b];if(this.property[b].child&&this.property[b].child.property==a)return this.property[b].child}},onOk:function(a){a=this._getContext();var b={},c=null;this.property.forEach(function(a){var d=a.property||a.child.property,e=this._getStringValueOfTextBox(d),d=dijit.byId("MultiFieldSmartInput_SmartInput_checkbox_"+d);if(!a.supportsHTML||
!d.checked)e=h.encode(e);a.child?(c=this.parseChildren(a,e),a.property&&(b[a.property]=this.getSelectedOption(this._widget,c))):b[a.property]=e}.bind(this));var d=new q(this._widget,b,c,a);a.getCommandStack().execute(d);this.hide()},parseChildren:function(a,b){for(var c=this._widget.getData(),d=this.parseItems(b),c=c.children,f=0;f<d.length;f++){b=d[f];var g=b.text;a.child.supportsHTML||(d[f].text=dojox.html.entities.decode(g));if(f<c.length){var e=c[f];e.children=g;e.properties.value=g;e.properties.selected=
b.selected}else e={},e.type=a.child.type,e.properties={},e.properties[a.child.property]=g,b.selected&&(e.properties.selected=b.selected),e.children=g||b,c.push(e)}if(0<d.length){g=c.length;for(f=d.length;f<g;f++)c.pop()}return c},hide:function(){if(this._inline){for(;connection=this._connection.pop();)connection&&dojo.disconnect(connection);var a=this._findSmartInputContainer(this._widget._edit_context.frameNode);if(a&&(this._loadingDiv&&a.removeChild(this._loadingDiv),"none"!=this._inline.style.display)){this._format=
this.getFormat();this._inline.style.display="none";this.destroyTooltips();this._inline.destroyRecursive();delete this._inline;var b=a.ownerDocument.getElementById("iebPointer");a.removeChild(b);this._widget.getContext().getDocument().defaultView.focus()}}},show:function(a){this._lastKeyCode=0;this._widget=p.byId(a);this._widget.getData();this._loading(255,200);dojo.addClass("ieb","MultiFieldSmartInput");a=this._getTemplate();this._inline.attr("content",a);this._connection.push(dojo.connect(this._inline,
"onBlur",this,"onOk"));this._connectHelpDiv();this._connectResizeHandle();this._connectSimDiv();this._loadingDiv&&(this._loadingDiv.style.backgroundImage="none");a=dijit.byId("MultiFieldSmartInput_SmartInput_"+(this.property[0].property||this.property[0].child.property));dijit.selectInputText(a.textbox);a.focus();this.connectEditBoxes();this.setStartSize();this.resize(null)},connectEditBoxes:function(){this.property.forEach(function(a){a=a.property||a.child.property;var b=dijit.byId("MultiFieldSmartInput_SmartInput_"+
a);this._connection.push(dojo.connect(b,"onMouseDown",this,"stopEvent"));this._connection.push(dojo.connect(b,"onKeyUp",this,"handleEvent"));var c=dojo.byId("MultiFieldSmartInput_SmartInput_checkbox_div_"+a),b=dijit.byId("MultiFieldSmartInput_SmartInput_checkbox_"+a);this._connection.push(dojo.connect(b,"onClick",this,"htmlCheckbox"));new w({id:"MultiFieldSmartInput_SmartInput_checkbox_"+a+"_tooltip",connectId:[c],label:"the text for the tooltip"});this.updateFormats(a)}.bind(this))},containsHtml:function(a){return dojo.create("div",
{innerHTML:a}).children.length?"html":"text"},htmlCheckbox:function(a){var b=a.currentTarget.id.split("_"),c=dijit.byId("MultiFieldSmartInput_SmartInput_"+b[b.length-1]),b=dijit.byId(a.currentTarget.id+"_tooltip"),c=c.getValue(),d="html";a.currentTarget.checked||(c=h.encode(c),d="text");b.attr("label","Format contents as "+d+":\x3cbr\x3e"+c)},setStartSize:function(){var a=0;dojo.query(".MultiFieldSmartInput_SmartInput_value","davinci.ve.input.MultiFieldSmartInput_table").forEach(function(b){a+=b.clientHeight+
5});dojo.byId("iedResizeDiv");dijit.byId("iedResizeDiv");dojo.style("iedResizeDiv","height",a+5+"px");dojo.style("iedResizeDiv","minHeight",a+5+"px")},handleEvent:function(a){for(var b=!1,c=0;c<this.property.length;c++){var d=this.property[c],f=d.property||d.child.property;if(-1<a.currentTarget.id.indexOf("MultiFieldSmartInput_SmartInput_"+f)){b=d.multiLine;break}}if(13==a.keyCode){if(!b||"false"==b||13==this._lastKeyCode)this.onOk()}else b=a.target.id.split("_"),f=b[b.length-1],this.updateFormats(f);
this._lastKeyCode=a.keyCode;this.updateSimStyle()},updateFormats:function(a){var b=this._getStringValueOfTextBox(a);this.getPropertyObject(a).supportsHTML&&this.containsHtmlMarkUp(b)?dojo.style("MultiFieldSmartInput_SmartInput_checkbox_div_"+a,"display",""):dojo.style("MultiFieldSmartInput_SmartInput_checkbox_div_"+a,"display","none");var c=dijit.byId("MultiFieldSmartInput_SmartInput_checkbox_"+a+"_tooltip"),d="html";dijit.byId("MultiFieldSmartInput_SmartInput_checkbox_"+a).checked||(b=h.encode(b),
d="text");c.attr("label","Format contents as "+d+":\x3cbr\x3e"+b);this.resize(null)},serializeChildren:function(a){var b=[];a.children.forEach(function(c){var d=c.properties.value?c.properties.value:c.children,d=h.decode(d);b.push((c.properties.selected||a.properties.value==d?"+":"")+d)}.bind(this));return b=this.serializeItems(b)},resize:function(a){var b=40;a=dojo.query(".MultiFieldSmartInput_SmartInput_label","davinci.ve.input.MultiFieldSmartInput_table");a.forEach(function(a){a.clientWidth>b&&
(b=a.clientWidth)});a.forEach(function(a){a.clientWidth<b&&dojo.style(a,"width",b+"px")});var c=0;a=dojo.query(".MultiFieldSmartInput_SmartInput_checkbox","davinci.ve.input.MultiFieldSmartInput_table");a.forEach(function(a){a.clientWidth>c&&(c=a.clientWidth)});a.forEach(function(a){a.clientWidth<c&&dojo.style(a,"width",c+"px")});var d=dojo.byId("iedResizeDiv");a=d.clientHeight-6;a=d.clientHeight-50;25>a&&(a=25);var f=[],g=0;this.property.forEach(function(a){var e=dijit.byId("MultiFieldSmartInput_SmartInput_"+
(a.property||a.child.property));e._setStyleAttr({width:d.clientWidth-(b+c+20)+"px"});a.multiLine?f.push(e):g+=e.domNode.clientHeight}.bind(this));if(0<f.length){var e=(d.clientHeight-g-25)/f.length;f.forEach(function(a){a._setStyleAttr({height:e+"px",maxHeight:e+"px"})}.bind(this))}dojo.style("ieb","width",d.clientWidth+15+"px");dojo.style("davinci.ve.input.SmartInput_radio_div","width",d.clientWidth+5+"px")},_getTemplate:function(){return this._substitutedMainTemplate=dojo.replace(t,{buttonOk:k.buttonOk,
buttonCancel:k.buttonCancel,tableContent:this._addPropertiesToHTML(),helpText:this.getHelpText()})},_addPropertiesToHTML:function(){var a=this._widget.getData(),b="";this.property.forEach(function(c){var d=a.properties[c.property]||"",f=this.containsHtmlMarkUp(d)?"checked":"",g=c.property||c.child.property;c.child&&(d=this.serializeChildren(a));if(c.multiLine)b+=dojo.replace(v,{label:this.getTitle(g),textboxId:"MultiFieldSmartInput_SmartInput_"+g,textboxValue:d,checkboxDivId:"MultiFieldSmartInput_SmartInput_checkbox_div_"+
g,checkboxId:"MultiFieldSmartInput_SmartInput_checkbox_"+g,checked:f});else{c=this._widget.metadata.property[g]?this._widget.metadata.property[g].format:null;var e="dijit/form/TextBox";c&&("date"==c?e="dijit/form/DateTextBox":"time"==c&&(e="dijit/form/TimeTextBox"));b+=dojo.replace(u,{label:this.getTitle(g),textboxType:e,textboxId:"MultiFieldSmartInput_SmartInput_"+g,textboxValue:d,checkboxDivId:"MultiFieldSmartInput_SmartInput_checkbox_div_"+g,checkboxId:"MultiFieldSmartInput_SmartInput_checkbox_"+
g,checked:f})}}.bind(this));return b},getSelectedOption:function(a,b){for(var c="",d=0;d<b.length;d++){var f=b[d];if(f.properties.selected){c=f.properties.value;break}}return c},_getStringValueOfTextBox:function(a){a=dijit.byId("MultiFieldSmartInput_SmartInput_"+a);var b=a.getValue();b&&b instanceof Date&&(a instanceof r?b=b.toISOString().substring(0,10):a instanceof s&&(b="T"+b.toTimeString().substring(0,8)));return b},updateSimStyle:function(){}})});
//# sourceMappingURL=MultiFieldSmartInput.js.map