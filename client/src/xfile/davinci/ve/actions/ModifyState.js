//>>built
require({cache:{"url:davinci/ve/actions/templates/ModifyState.html":'\x3cdiv\x3e\n\t\x3cdiv class\x3d"dijitDialogPaneContentArea"\x3e\n\t\t\x3cdiv class\x3d\'modify_state_container\'\x3e\n\t\t\t\x3cdiv data-dojo-type\x3d"dijit.form.DropDownButton" label\x3d\'${veNls.renameLabel}\' dojoAttachPoint\x3d"renameButton" class\x3d"modify_state_rename_button"\x3e\n\t\t\t\t\t\x3cdiv data-dojo-type\x3d"dijit.TooltipDialog" class\x3d\'modify_state_rename_container\' id\x3d\'state_rename_tooltip_dialog\'\x3e\n\t\t\t\t\t\t\x3cdiv\x3e\n\t\t\t\t\t\t\t\x3clabel for\x3d"state_rename_new_name"\x3e${veNls.newStateLabel}\x3c/label\x3e\n\t\t\t\t\t\t\t\x3cinput data-dojo-type\x3d"dijit.form.ValidationTextBox" id\x3d"state_rename_new_name" name\x3d"state_rename_new_name"\x3e\x3c/input\x3e\n\t\t\t\t\t\t\x3c/div\x3e\n\t\t\t\t\t\t\x3cdiv\x3e\n\t\t\t\t\t\t\t\x3cbutton id\x3d"state_rename_do_it" dojoType\x3d\'dijit.form.Button\' label\x3d\'${veNls.renameLabel}\'\x3e\x3c/button\x3e\n\t\t\t\t\t\t\t\x3cbutton id\x3d"state_rename_cancel" dojoType\x3d\'dijit.form.Button\' label\x3d\'${veNls.cancelLabel}\'\x3e\x3c/button\x3e\n\t\t\t\t\t\t\x3c/div\x3e\n\t\t\t\t\t\x3c/div\x3e\n\t\t\t\t\x3c/div\x3e\n\t\t\t${veNls.stateLabel}: \x3cspan id\x3d\'modify_state_old_name\'\x3eaaa\x3c/span\x3e\n\t\t\x3c/div\x3e\n\t\t\x3cdiv class\x3d\'initial_state_row\'\x3e\n\t\t\t\x3cinput data-dojo-type\x3d"dijit.form.CheckBox" dojoAttachPoint\x3d"initialState" id\x3d"modify_state_initial_state" name\x3d"modify_state_initial_state"\x3e\x3c/input\x3e\n\t\t\t\x3clabel for\x3d\'modify_state_initial_state\'\x3e${veNls.initialStateCheckBoxLabel}\x3c/label\x3e\n\t\t\x3c/div\x3e\n\t\x3c/div\x3e\n\t\t\t\t\n\t\x3cdiv class\x3d"dijitDialogPaneActionBar"\x3e\n\t\t\x3cbutton dojoType\x3d\'dijit.form.Button\' dojoAttachPoint\x3d"okButton" label\x3d\'${veNls.modifyLabel}\' class\x3d"maqPrimaryButton"\x3e\x3c/button\x3e\n\t\t\x3cbutton dojoType\x3d\'dijit.form.Button\' dojoAttachPoint\x3d"cancelButton" label\x3d\'${commonNls.buttonCancel}\' class\x3d"maqSecondaryButton"\x3e\x3c/button\x3e\n\t\x3c/div\x3e\n\x3c/div\x3e\n'}});
define("davinci/ve/actions/ModifyState","dojo/_base/declare dojo/Deferred dojo/_base/connect dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dijit/popup dijit/focus davinci/ve/States davinci/ui/Dialog davinci/Runtime davinci/Workbench davinci/actions/Action dojo/i18n!davinci/ve/nls/ve dojo/i18n!dijit/nls/common dojo/text!./templates/ModifyState.html dijit/form/TextBox dijit/form/ValidationTextBox davinci/commands/CompoundCommand davinci/ve/commands/AppStateCommand".split(" "),
function(k,n,p,q,r,s,l,t,e,A,d,u,v,m,w,x,B,C,y,z){var h=null;k("davinci.ve.actions.ModifyStateWidget",[q,r,s],{templateString:x,widgetsInTemplate:!0,veNls:m,commonNls:w,isNormalState:!1,newName:null,oldInitialStateOn:null,postCreate:function(){this._connections=[];dijit.byId("state_rename_tooltip_dialog");h.then(function(){if(!this._statesFocus.state||this._statesFocus.state===e.NORMAL)this.isNormalState=!0;var a=dojo.byId("modify_state_old_name");a&&(this._statesFocus&&this._statesFocus.state&&!this.isNormalState?
a.innerHTML=this._statesFocus.state:(a.innerHTML="\x3ci\x3e"+e.NORMAL+"\x3c/i\x3e",this.renameButton.set("disabled",!0)));this.oldInitialStateOn=a=e.getInitial(this._statesFocus.stateContainerNode)===this._statesFocus.state;this.initialState.set("checked",a);a&&this.isNormalState&&this.initialState.set("disabled",!0);this._dialog.connect(this._dialog,"hide",function(a){this.onClose()}.bind(this));this.okButton.connect(this.okButton,"onClick",dojo.hitch(this,function(a){this.onOk(a)}));this.cancelButton.connect(this.cancelButton,
"onClick",dojo.hitch(this,function(a){this.onCancel(a)}));if(a=dijit.byId("state_rename_tooltip_dialog"))a.connect(a,"onShow",function(a){this.renameStateShowTooltipDialog(a)}.bind(this)),a.connect(a,"onHide",function(a){this.renameStateHideTooltipDialog(a)}.bind(this))}.bind(this))},renameStateShowTooltipDialog:function(a){a=dojo.byId("modify_state_old_name");var b=dojo.byId("state_rename_new_name"),c=dijit.byId("state_rename_new_name");a&&c&&c.set("value",a.innerText);t.focus(b);a=dijit.byId("state_rename_do_it");
b=dijit.byId("state_rename_cancel");a.connect(a,"onMouseDown",function(a){a.stopPropagation()});b.connect(a,"onMouseDown",function(a){a.stopPropagation()});a.connect(a,"onClick",function(a){this.renameStateDoIt(a)}.bind(this));b.connect(b,"onClick",function(a){a=dijit.byId("state_rename_tooltip_dialog");l.close(a)}.bind(this))},renameStateDoIt:function(a){a=dojo.byId("modify_state_old_name");var b=dijit.byId("state_rename_new_name"),b=b?b.get("value"):null,c=dijit.byId("state_rename_tooltip_dialog");
a&&b&&(this.newName=a.innerHTML=b);c&&l.close(c)},renameStateHideTooltipDialog:function(a){},onOk:function(a){if(d.currentEditor&&d.currentEditor.currentEditor&&d.currentEditor.currentEditor.context){a=d.currentEditor.currentEditor.context;var b=e.getFocus(a.rootNode);if(b&&b.stateContainerNode){var c;this.newName&&this.newName!==this._statesFocus.state&&(c=this.newName);var f,g=this.initialState.get("checked");g!==this.oldInitialStateOn&&(f=b.state?b.state:"undefined",f=g?f:null);if(c||f)g=new y,
g.add(new z({action:"modify",state:b.state,stateContainerNode:b.stateContainerNode,context:a,newState:c,initialState:f})),a.getCommandStack().execute(g);this.onClose()}}},onCancel:function(){this.onClose()},onClose:function(a){for(;a=this._connections.pop();)p.disconnect(a)}});return k("davinci.ve.actions.ModifyState",[v],{run:function(){var a;if(d.currentEditor&&(d.currentEditor.currentEditor&&d.currentEditor.currentEditor.context)&&(a=d.currentEditor.currentEditor.context,a=e.getFocus(a.rootNode))){h=
new n;var b=new davinci.ve.actions.ModifyStateWidget,c=u.showModal(b,m.modifyState);this._dialog=b._dialog=c;b._statesFocus=a;h.resolve()}}})});
//# sourceMappingURL=ModifyState.js.map