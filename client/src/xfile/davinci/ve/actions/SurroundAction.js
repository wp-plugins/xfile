//>>built
define("davinci/ve/actions/SurroundAction","dojo/_base/declare dojo/_base/array dojo/dom-style davinci/ve/actions/ContextAction davinci/commands/CompoundCommand davinci/ve/commands/AddCommand davinci/ve/commands/StyleCommand davinci/ve/commands/MoveCommand davinci/ve/commands/ResizeCommand davinci/ve/commands/ReparentCommand davinci/ve/tools/CreateTool davinci/ve/widget davinci/ve/utils/GeomUtils".split(" "),function(v,l,w,x,y,z,A,q,B,C,D,E,s){return v("davinci.ve.actions.SurroundAction",[x],{run:function(a){a=
this.fixupContext(a);var g,f,h,r,b=[],e,t=this.item.surroundWithTagName;if(t){dojo.withDoc(a.getDocument(),function(){e=E.createWidget({type:"html."+t,properties:{},children:[],context:a})});var d=new y,k=[].concat(a.getSelection()),u=k[0],m=u.getParent();s.getMarginBoxPageCoords(m.domNode);k.sort(function(b,c){return m.indexOf(b)-m.indexOf(c)});var n=a.getDocument(),p=n.defaultView&&n.defaultView.dojo;p.style||(p.style=w);(n=l.every(k,function(b){if(p)return position_prop=p.style(b.domNode,"position"),
"absolute"==position_prop}))&&l.forEach(k,function(a,c){b.push(s.getMarginBoxPageCoordsCached(a.domNode));d.add(new q(a,b[c].l,b[c].t,null,b[c]))});d.add(new z(e,m,m.indexOf(u)));D.prototype.checkAddToCurrentState(d,e);n&&(d.add(new A(e,[{position:"absolute"}])),l.forEach(k,function(a,c){var d=b[c].l+b[c].w,e=b[c].t+b[c].h;if(0==c||b[c].l<g)g=b[c].l;if(0==c||b[c].t<f)f=b[c].t;if(0==c||d>h)h=d;if(0==c||e>r)r=e}),d.add(new q(e,g,f)),d.add(new B(e,h-g,r-f)));l.forEach(k,function(b){d.add(new C(b,e,"last"))});
n&&l.forEach(k,function(a,c){d.add(new q(a,b[c].l,b[c].t,null,b[c]))});a.getCommandStack().execute(d);a.select(e)}else console.error("missing surroundWithTagName")},isEnabled:function(a){if((a=this.fixupContext(a))&&a.getSelection().length){var g=a.getSelection()[0].getParent(),f=[];if(!g)return!1;if(l.every(a.getSelection(),function(a){var b=a.getParent();if(!b)return!1;f.push(g.indexOf(a));return g.id==b.id})){f.sort();var h;for(a=f.shift();f.length;a=h)if(h=f.shift(),h!=a+1)return!1;return!0}}return!1}})});
//# sourceMappingURL=SurroundAction.js.map