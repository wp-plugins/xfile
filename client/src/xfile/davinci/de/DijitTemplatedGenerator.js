//>>built
define("davinci/de/DijitTemplatedGenerator",["dojo/_base/declare","davinci/model/Path","davinci/ve/metadata","dojo/json"],function(l,n,k,m){return l("davinci.de.DijitTemplatedGenerator",null,{constructor:function(b){dojo.mixin(this,b)},buildSource:function(b,d,a,f,g,h){this.value={js:"",metadata:"",amd:["dojo/_base/declare","dijit/_Widget","dijit/_Templated"]};this.metadata={id:a,name:a,spec:"1.0",version:"1.0",require:[],library:{dojo:{src:"../../dojo/dojo/dojo.js"}}};this.model=this._srcDocument=
b;b=h[0]._srcElement;a=a+"/"+a+".html";f||(this.value.amd.push("dojo/text!"+a.toString()),this.value.htmlPath=a);g=b.find({elementType:"HTMLElement"});g.push(b);this.loadRequires("html.body",!0,!0,!0);h={};for(a=0;a<g.length;a++){var c=g[a],c=c.getAttribute("data-dojo-type")||c.getAttribute("dojoType")||c.getAttribute("dvwidget");null!=c&&this.loadRequires(c,!0,!0,!0);var c=k.query(c,"library"),e;for(e in c)h[e]=c[e]}this.metadata.require.push({$library:"dojo",format:"amd",src:d,type:"javascript-module"});
for(e in h)"dojo"!=e&&(this.metadata.library[e]={});this.value.html="";this.value.html+=b.getText();this.value.html+="";this.metadata.content="\x3cdiv\x3e\x3c/div\x3e";this.value.js="define([";for(a=0;a<this.value.amd.length;a++)this.value.js+="'"+this.value.amd[a]+"'",a+1<this.value.amd.length&&(this.value.js+=",\n");this.value.js+="\n],function(";for(a=0;3>a;a++)d=this.value.amd[a].split("/"),this.value.js+=d[d.length-1],3>a+1&&(this.value.js+=",");f||(this.value.js+=",templateString");this.value.js+=
"){\n\n";this.value.js+=" return declare([ _Widget, _Templated";this.value.js+="], {\n";this.value.js+="       widgetsInTemplate:true,\n";f?(this.value.js+="       templateString:'"+this.escapeHtml(this.value.html)+"'",delete this.value.html):this.value.js+="       templateString:templateString";this.value.js+="   \n});";this.value.js+="\n});";this.value.metadata=m.stringify(this.metadata,void 0,"\t");return this.value},escapeHtml:function(b){b=b.replace(/"/g,'\\"');return b=b.replace(/\n/g,"")},
addMetaData:function(b){for(var d=0;d<this.metadata.require.length;d++){var a=this.metadata.require[d];if(a.$library==b.$library&&a.src==b.src&&a.type==b.type&&a.format==b.format)return}this.metadata.require.push(b)},loadRequires:function(b,d,a,f){if(!b)return!1;b=k.query(b,"require");if(!b)return!0;b.every(function(a){this.addMetaData(a)},this)}})});
//# sourceMappingURL=DijitTemplatedGenerator.js.map