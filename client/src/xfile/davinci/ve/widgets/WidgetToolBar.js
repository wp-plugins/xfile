//>>built
require({cache:{"url:davinci/ve/widgets/templates/WidgetToolBar.html":'\x3cdiv class\x3d"propertiesTitleBar ui-widget-content" style\x3d"display: none"\x3e\n\t\x3cdiv class\x3d\'propertiesWidgetDescription\'\x3e\n\t\t\x3cspan class\x3d\'propertiesWidgetDescriptionFor\'\x3e${veNLS.toolBarFor}\x3c/span\x3e\n\t\t\x3cspan data-dojo-attach-point\x3d"descNode"\x3e${veNLS.noSelection}\x3c/span\x3e\n\t\x3c/div\x3e\n\n\t\x3cdiv class\x3d"propertiesTitleBarPropertiesContainer ui-widget-content"\x3e\n\t\t\x3ctable width\x3d"100%" cellspacing\x3d"0" cellpadding\x3d"0" border\x3d"0" align\x3d"center" class\x3d"propertiesTitleBarProperties property_table_stretchable"\x3e\n\t\t\t\x3ccolgroup\x3e\x3ccol style\x3d"width:10px;"\x3e\x3ccol class\x3d"gap02"\x3e\x3ccol class\x3d"gap03"\x3e\x3ccol style\x3d"width:10px;"\x3e\x3ccol style\x3d"width:6px;"\x3e\x3c/colgroup\x3e\n\t\t\t\x3ctbody\x3e\n\t\t\t\t\x3ctr class\x3d"cssPropertySection"\x3e\n\t\t\t\t\t\x3ctd\x3e\x3c/td\x3e\n\t\t\t\t\t\x3ctd class\x3d"propertyDisplayName"\x3e${veNLS.toolBarClass}\x26nbsp;\x3c/td\x3e\n\t\t\t\t\t\x3ctd class\x3d"propertyInputField"\x3e\n\t\t\t\t\t  \x3cinput data-dojo-type\x3d"dijit.form.ComboBox" data-dojo-attach-point\x3d"classComboBox" label\x3d"" data-dojo-attach-event\x3d"onChange:_onChangeClassAttribute,onFocus:_onFieldFocus,onBlur:_onFieldBlur" style\x3d"width: 100%" searchAttr\x3d"name"/\x3e\n\t\t\t\t\t\x3c/td\x3e\n\t\t\t\t\t\x3ctd nowrap\x3d"true" class\x3d"propertyExtra"\x3e\x3c/td\x3e\n\t\t\t\t\t\x3ctd\x3e\x3c/td\x3e\n\t\t\t\t\x3c/tr\x3e\n\t\n\t\t\t\t\x3ctr class\x3d"cssPropertySection"\x3e\n\t\t\t\t\t\x3ctd\x3e\x3c/td\x3e\n\t\t\t\t\t\x3ctd class\x3d"propertyDisplayName"\x3e${veNLS.toolBarId}\x26nbsp;\x3c/td\x3e\n\t\t\t\t\t\x3ctd class\x3d"propertyInputField"\x3e\n\t\t\t\t\t  \x3cinput data-dojo-type\x3d"dijit.form.ValidationTextBox" data-dojo-attach-point\x3d"idTextBox" label\x3d"" data-dojo-attach-event\x3d"onChange:_onChangeIDAttribute,onKeyPress:_onKeyPress,onFocus:_onFieldFocus,onBlur:_onFieldBlur" style\x3d"width: 100%"/\x3e\n\t\t\t\t\t\x3c/td\x3e\n\t\t\t\t\t\x3ctd nowrap\x3d"true" class\x3d"propertyExtra"\x3e\x3c/td\x3e\n\t\t\t\t\t\x3ctd\x3e\x3c/td\x3e\n\t\t\t\t\x3c/tr\x3e\n\t\t\t\x3c/tbody\x3e\n\t\t\x3c/table\x3e\n\t\x3c/div\x3e\n\x3c/div\x3e\n'}});
define("davinci/ve/widgets/WidgetToolBar","dojo/_base/declare dijit/_Templated dijit/_Widget davinci/Runtime davinci/workbench/ViewLite davinci/ve/commands/ModifyCommand dijit/form/ComboBox dijit/form/ValidationTextBox dijit/form/TextBox dojo/store/Memory dojo/i18n!davinci/ve/nls/ve dojo/i18n!dijit/nls/common davinci/ve/widget dojo/text!./templates/WidgetToolBar.html".split(" "),function(g,h,k,l,m,n,r,s,t,p,d,u,e,q){return g("davinci.ve.widgets.WidgetToolBar",[m,k,h],{templateString:q,widgetsInTemplate:!0,
descNode:null,idTextBox:null,classComboBox:null,widgetDescStart:"",widgetDescUnselectEnd:"",_oldIDName:null,_oldClassName:null,veNLS:d,postCreate:function(){this.idTextBox.validator=dojo.hitch(this,function(a,b){this.invalidMessage=null;if(!a||!this._widget||this.changing)return!0;var c=e.byId(a);return c&&c!==this._widget?(this.invalidMessage=d.idAlreadyUsed,!1):!0});dojo.subscribe("/davinci/ui/widget/replaced",dojo.hitch(this,this._widgetReplaced))},initialize:function(){if((this._editor=l.currentEditor)&&
this._editor.visualEditor&&this._editor.visualEditor.context){var a=this._editor.visualEditor.context.getSelection();this._widget=0==a.length?null:a[0]}else this._widget=null;this.onWidgetSelectionChange()},onEditorSelected:function(){this.initialize();this.domNode.style.display=this._editor&&"davinci.ve.HTMLPageEditor"==this._editor.editorID?"block":"none"},_widgetReplaced:function(a,b){this._widget===b&&(this._widget=a,this.onWidgetSelectionChange())},onWidgetSelectionChange:function(){var a="";
if(this._widget){a=e.getLabel(this._widget);this.context=this._widget.getContext();this.classComboBox.set("disabled",!1);this.idTextBox.attr("disabled",!1);this.changing=!0;this._oldClassName=this._oldIDName=null;dojo.addClass(this.domNode,"propertiesSelection");this.descNode.innerHTML=a;if(this._editor&&"davinci.ve.PageEditor"===this._editor.declaredClass&&(a=this._widget._srcElement)){var b=[],c=this._widget.getContext().getModel().getDocumentElement();if(c){var f={visit:function(a){if("HTMLElement"==
a.elementType&&("body"!=a.tag&&"html"!=a.tag)&&(a=a.getAttribute("class")))a=dojo.trim(a).split(" "),dojo.forEach(a,dojo.hitch(this,function(a){-1==dojo.indexOf(this.classes,a)&&this.classes.push(a)}))},classes:[]};c.visit(f);dojo.forEach(f.classes,function(a){b.push({name:a})})}c=new p({data:b});this.classComboBox.set("store",c);a=(a=a.getAttribute("class"))&&dojo.trim(a)||"";this.classComboBox.set("value",a);this._oldClassName=a;this._oldIDName=a=(a=this._widget.getId())&&dojo.trim(a)||"";this.idTextBox.attr("value",
a)}this.changing=!1}else this.descNode.innerHTML=d.noSelection,dojo.removeClass(this.domNode,"propertiesSelection"),this.context=null,this.classComboBox.set("value",""),this.classComboBox.set("disabled",!0),this.idTextBox.attr("value",""),this.idTextBox.attr("disabled",!0)},_onChangeIDAttribute:function(){if(this._widget&&!this.changing){var a=this.idTextBox;if(a&&a.isValid()&&(this.context&&this.context.blockChange(!1),a=a.attr("value"),a!==this._oldIDName)){this._oldIDName=a;var b={};b.id=a;a=new n(this._widget,
b,null);dojo.publish("/davinci/ui/widgetPropertiesChanges",[{source:this._editor.editor_id,command:a}])}}},_onChangeClassAttribute:function(){if(this._widget&&!this.changing){var a=this.classComboBox;if(a&&(this.context&&this.context.blockChange(!1),a=a.attr("value"),a!==this._oldClassName)){this._oldClassName=a;var b={};b["class"]=a;a=new davinci.ve.commands.ModifyCommand(this._widget,b,null);dojo.publish("/davinci/ui/widgetPropertiesChanges",[{source:this._editor.editor_id,command:a}])}}},_onFieldFocus:function(){this.context&&
this.context.blockChange(!0)},_onFieldBlur:function(){this.context&&this.context.blockChange(!1)},_onKeyPress:function(a){a.keyCode==dojo.keys.ENTER&&this._onChangeIDAttribute()}})});
//# sourceMappingURL=WidgetToolBar.js.map