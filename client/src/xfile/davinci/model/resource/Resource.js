//>>built
define("davinci/model/resource/Resource","dojo/_base/declare dojo/_base/xhr dojo/_base/connect dojo/Deferred davinci/Runtime davinci/model/Model davinci/model/Path xide/manager/ServerActionBase".split(" "),function(g,h,e,k,l,m,n,p){return g("davinci.model.resource.Resource",[m,p],{singleton:!0,sync:!1,serviceUrl:"../xcf/xui.php?debug\x3dtrue\x26view\x3drpc",workspaceMount:"/ws/",_initService:function(){var a=this.findServiceUrl(this.declaredClass);a&&(this.serviceUrl=a);this.inherited(arguments)},
constructor:function(){this.elementType="Resource";this.name="";this.parent=null;this._id=dijit.getUniqueId("maqFileResource");this.init()},getName:function(){return this.name},getPath:function(){return this.parent?this.parent.getPath()+"/"+this.name:this.name},readOnly:function(){return this.hasOwnProperty("_readOnly")?this._readOnly||null!=this.parent&&this.parent.readOnly():this.parent?this.parent.readOnly():!1},getURL:function(){var a=this.getPath();0==a.indexOf("./")&&(a=a.substring(2,a.length));
return l.getUserWorkspaceUrl()+a},rename:function(a){var b=(new n(this.getPath())).removeLastSegments().append(a);return h.get({url:"cmd/rename",handleAs:"text",content:{oldName:this.getPath(),newName:b.toString()}}).then(function(){this.name=a;e.publish("/davinci/resource/resourceChanged",["renamed",this])}.bind(this))},getParentFolder:function(){return"File"==this.elementType?this.parent:this},isVirtual:function(){return!!this.libraryId},visit:function(a,b){var d=a.visit(this);!this._isLoaded&&
"Folder"==this.elementType&&!b?this.getChildren(dojo.hitch(this,function(){dojo.forEach(this.children,function(c){c.visit(a,b)})})):this.children&&!d&&dojo.forEach(this.children,function(c){c.visit(a,b)})},deleteResource:function(a){var b=""+this.getPath();"."==b&&(b=""+this.workspaceMount);var b=b.replace("./",this.workspaceMount),d=this.serviceClass,c="Folder"==this.elementType?"deleteDirectory":"deleteFile",f=function(){var a=this.getName();this.parent.children.some(function(b,c,d){if(b.getName()==
a)return d.splice(c,1),!0});e.publish("/davinci/resource/resourceChanged",["deleted",this])}.bind(this);a?(a=new k,f(),a.resolve()):a=this.serviceObject[d][c](b).then(f,function(){});return a},getId:function(){return this._id}})});
//# sourceMappingURL=Resource.js.map