//>>built
define("davinci/ve/commands/ReparentCommand",["dojo/_base/declare","davinci/ve/commands/_hierarchyCommand","../widget","../States","davinci/ve/commands/ModifyCommand"],function(l,m,g,k,h){return l("davinci.ve.commands.ReparentCommand",[m],{name:"reparent",constructor:function(a,b,c){this._id=a?a.id:void 0;this._newParentId=b?b.id:"myapp";this._newIndex=c},execute:function(){if(this._id&&this._newParentId){var a=g.byId(this._id);if(a){var b=a.getParent();b||(b=dojo.byId("myapp"));var c=g.byId(this._newParentId);
c||(c=dojo.byId("myapp"));var d=this._isRefreshOnDescendantChange(a);this._oldParentId||(this._oldParentId=b.id,this._oldIndex=dojo.indexOf(b.getChildren(),a),this._newIndex&&this._newIndex.domNode&&(this._newIndex=c.indexOf(this._newIndex)));b.removeChild(a);var e=c.getContext();c.addChild(a,c==b&&this._oldIndex<this._newIndex?this._newIndex-1:this._newIndex);if(e){var f=a.getHelper();f&&f.reparent&&f.reparent(a);a.startup();a.renderWidget();e.widgetChanged(e.WIDGET_REPARENTED,a,[b,c]);b=this._isRefreshOnDescendantChange(a);
d&&(d=new h(d,null,null,e),d.execute());b&&(d=new h(b,null,null,e),d.execute())}k.resetState(a.domNode)}}},undo:function(){if(this._id&&this._oldParentId&&this._newParentId){var a=g.byId(this._id);if(a){var b=g.byId(this._oldParentId);if(b){var c=g.byId(this._newParentId);if(c){var d=this._isRefreshOnDescendantChange(a),e=b.getContext();c.removeChild(a);b.addChild(a,this._oldIndex);if(e){var f=a.getHelper();f&&f.reparent&&f.reparent(a);a.startup();a.renderWidget();e.widgetChanged(e.WIDGET_REPARENTED,
a,[b,c]);b=this._isRefreshOnDescendantChange(a);d&&(d=new h(d,null,null,e),d.execute());b&&(d=new h(b,null,null,e),d.execute())}k.resetState(a.domNode)}}}}}})});
//# sourceMappingURL=ReparentCommand.js.map