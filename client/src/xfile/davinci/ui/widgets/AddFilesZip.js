//>>built
define("davinci/ui/widgets/AddFilesZip","dojo/_base/declare ./AddFiles ../../model/Path system/resource dijit/ProgressBar dojo/i18n!../nls/ui".split(" "),function(k,l,m,e,n,p){return k(l,{_getCommand:function(){return this.inherited(arguments)+"\x26explodeZip\x3d1"},onClose:function(){},postCreate:function(){dojo.style(this.zipWarning,"display","block");var c=e.getRoot();this.selectedResource&&(c="Folder"==this.selectedResource.elementType?this.selectedResource:this.selectedResource.parent);this.fileDialogParentFolder.innerHTML=
c.getPath();this.uploader.set("multiple",!1);this.uploader.set("label",p.selectZip);this.uploader.set("url",this._getCommand(c));var d,b=this.uploadBtn;b.set("disabled",!0);var f=this.uploader;dojo.connect(this.uploader,"onChange",function(a){d&&dojo.disconnect(d);d=dojo.connect(b,"onClick",this,function(){f.set("disabled",!0);this.progress=new n({},this.zipWarning);f.upload()});b.oldText&&(b.containerNode.innerText=b.oldText);a=a[0].name;var g=/\.zip$/i.test(a);this.filelist.innerText=g?dojo.replace("Selected: {0}",
[a]):"";b.set("disabled",!g)}.bind(this));var h=function(){dojo.disconnect(d);this.onClose()}.bind(this);dojo.connect(this.uploader,"onProgress",this,function(a){this.progress.set("value",a.percent)});dojo.connect(this.uploader,"onComplete",function(a){a.forEach(function(a){var b=new m(c.getPath());-1==a.file.indexOf("/")?(c._appendFiles([{isDir:!1,isLib:!1,isNew:!1,name:a.file}]),b.append(a.file),a="updated"):(c.getChildrenSync(function(){},!0),a="reload");e.resourceChanged(a,b.toString())});h()});
dojo.connect(this.uploader,"onError",function(a){console.error("Upload error: ",a);h()})}})});
//# sourceMappingURL=AddFilesZip.js.map