//>>built
define("davinci/ve/commands/AddCommand","dojo/_base/declare davinci/ve/commands/_hierarchyCommand davinci/ve/widget davinci/ve/utils/ImageUtils davinci/ve/States davinci/ve/commands/ModifyCommand".split(" "),function(h,k,e,l,f,g){return h("davinci.ve.commands.AddCommand",[k],{name:"add",constructor:function(a,c,b){a&&(a.domNode?this._id=a.id:this._data=a);this._parentId=c.id;this._index=b},execute:function(){var a=e.byId(this._parentId);if(a){var c=a.getContext(),b=void 0;this._data?(this._id&&this._data.properties&&
(this._data.properties.id=this._id),b=e.createWidget(this._data),this._id=b.id):this._id&&(b=e.byId(this._id,c));if(b){this._data=b.getData();this._data.properties.id=this._id;this._data.context=c;if(this._index&&"number"!=typeof this._index)if(this._index.domNode)this._index=a.indexOf(this._index);else{var d=e.byId(this._index.id,c);this._index=a.indexOf(d)}"IMG"===b.domNode.tagName&&l.ImageUpdateFocus(b,c);a.addChild(b,this._index);c&&(c.attach(b),b.startup(),b.renderWidget(),c.widgetAddedOrDeleted(),
c.widgetChanged(c.WIDGET_ADDED,b));(c=this._isRefreshOnDescendantChange(b))&&(new g(c,null,null,a._edit_context)).execute();f.resetState(b.domNode)}}},undo:function(){if(this._id&&this._parentId){var a=e.byId(this._id);if(a){var c=e.byId(this._parentId);if(c){var b=this._isRefreshOnDescendantChange(a),d=a.getContext();d&&(d.detach(a),d.deselect(a));c.removeChild(a);d.widgetChanged(d.WIDGET_REMOVED,a);a.destroyWidget();d&&d.widgetAddedOrDeleted();b&&(new g(b,null,null,c._edit_context)).execute();f.resetState(a.domNode)}}}}})});
//# sourceMappingURL=AddCommand.js.map