//>>built
define("davinci/ui/ModelEditor",["dojo/_base/declare","../Runtime","./TextEditor","../commands/SourceChangeCommand"],function(d,e,f,g){return d(f,{constructor:function(b,a){this.subscribe("/davinci/ui/selectionChanged",this.selectModel)},colorize:function(b){return null},setContent:function(b,a){this.inherited(arguments);this.model.fileName=b;this.model.setText(a)},getHoverText:function(b,a){var c=this.convertMouseToLine(b,a);return this.model.findChildAtPosition({startOffset:c.row,endOffset:c.col}).getLabel()},
handleChange:function(b){this.inherited(arguments);var a=this.model.getText(),c=e.currentEditor;c&&c.getCommandStack?(c=c.getCommandStack(),a=new g({model:this.model,oldText:a,newText:b}),c.execute(a)):(this.model.setText(b),dojo.publish("/davinci/ui/modelChanged",[{newModel:this.model}]))},selectModel:function(b,a){if(!(this.publishingSelect||a&&this!=a)&&b.length&&b[0].model){var c=b[0].model;c.elementType&&(c=this.model.mapPositions(c),this.select(c))}},selectionChange:function(b){var a=this.model.mapPositions(this.model),
a=this.model.endOffset-a.endOffset,a=this.model.findChildAtPosition({startOffset:b.startOffset+a,endOffset:b.endOffset+a-1});b.model=a;if(a!=this._selectedModel)try{this.publishingSelect=!0,dojo.publish("/davinci/ui/selectionChanged",[[b],this])}finally{this.publishingSelect=!1}this._selectedModel=a},getSyntaxPositions:function(b,a){this.model.setText(b);if(this.model.getSyntaxPositions)return this.model.getSyntaxPositions(a).sort(function(a,b){return a.line!=b.line?a.line-b.line:a.col-b.col})},save:function(){this.model.setText(this.getText());
this.inherited(arguments)},getErrors:function(){return this.model.errors||[]}})});
//# sourceMappingURL=ModelEditor.js.map