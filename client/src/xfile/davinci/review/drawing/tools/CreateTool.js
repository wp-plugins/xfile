//>>built
define("davinci/review/drawing/tools/CreateTool",["dojo/_base/declare","./_ToolCommon","./scaffolds/scaffolds"],function(d,e,c){return d("davinci.review.drawing.tools.CreateTool",e,{constructor:function(a,b){a.createTool=this},setShape:function(a,b){if(!this.surface.isDrawing)switch(this.shapeAttributeMap=b,this.scaffold&&this.scaffold.destroy(),a){case "Arrow":this.scaffold=new c.ArrowScaffold(this.surface);this.scaffold.type="arrow";break;case "Rectangle":this.scaffold=new c.RectangleScaffold(this.surface);
this.scaffold.type="rectangle";break;case "Ellipse":this.scaffold=new c.EllipseScaffold(this.surface);this.scaffold.type="ellipse";break;case "Text":this.scaffold=new c.TextScaffold(this.surface);this.scaffold.type="text";break;default:Error("Invalid shape type!")}},activate:function(){if(!this.surface.isDrawing){this.surface.isDrawing=!0;var a=this.surface.docNode=this.surface.domNode,b=this.surface.htmlNode=a.documentElement,c=this.surface.bodyNode=a.body,b=this.surface.coverDiv=dojo.create("div",
{style:"z-index:2000000;cursor:crosshair;position:absolute; left:0px; top:0px; width:"+b.offsetWidth+"px; height:"+b.offsetHeight+"px;"},c);this._evtConns=[dojo.connect(b,"mousedown",this,"_mouseDown"),dojo.connect(a,"keydown",this,"_keyDown")]}},_mouseDown:function(a){dojo.stopEvent(a);this.surface.appendShape(this.scaffold.createShape(a.pageX,a.pageY,this.shapeAttributeMap));"text"==this.scaffold.type&&(this.scaffold.shape.filterAttributes=this.filterAttributes);this._evtConns.push(dojo.connect(this.surface.coverDiv,
"mouseup",this,"_mouseUp"),dojo.connect(this.surface.coverDiv,"mousemove",this,"_mouseMove"))},_mouseUp:function(a){this.scaffold.getEditMode&&this.scaffold.getEditMode();this.deactivate()},_mouseMove:function(a){this.surface.isDrawing&&this.scaffold.transformShape(a.pageX,a.pageY)},_keyDown:function(a){a.keyCode==dojo.keys.ESCAPE&&this.deactivate()},deactivate:function(){if(this.surface&&this.surface.isDrawing){this.surface.isDrawing=!1;this.scaffold.destroy();this.scaffold=null;this.inherited(arguments);
var a=this.surface.coverDiv;if(a){var b=a.parentNode;b&&b.removeChild(a);this.surface.coverDiv=null}}}})});
//# sourceMappingURL=CreateTool.js.map