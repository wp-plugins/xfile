//>>built
require({cache:{"url:davinci/review/widgets/templates/PublishWizard.html":'\x3cdiv class\x3d\'publishWizard\'\x3e\n\t\x3cdiv class\x3d"dijitDialogPaneContentArea"\x3e\n\t\t\x3cdiv class\x3d\'steps\'\x3e\n\t\t\t\x3cdiv dojoAttachPoint\x3d"navPage1" dojoAttachEvent\x3d"onclick:select" class\x3d"crumbs current sep"\x3e\n\t\t\t\t\x3cdiv dojoAttachPoint\x3d"navPage1Icon" class\x3d"done"\x3e\x3c/div\x3e\n\t\t\t\t1.${generalInfo}\n\t\t\t\x3c/div\x3e\n\t\t\t\x3cdiv dojoAttachPoint\x3d"navPage2" dojoAttachEvent\x3d"onclick:select" class\x3d"crumbs sep"\x3e\n\t\t\t\t\x3cdiv dojoAttachPoint\x3d"navPage2Icon" class\x3d"todo"\x3e\x3c/div\x3e\n\t\t\t\t2.${selectRevFiles}\n\t\t\t\x3c/div\x3e\n\t\t\t\x3cdiv dojoAttachPoint\x3d"navPage3" dojoAttachEvent\x3d"onclick:select" class\x3d"crumbs"\x3e\n\t\t\t\t\x3cdiv dojoAttachPoint\x3d"navPage3Icon" class\x3d"todo"\x3e\x3c/div\x3e\n\t\t\t\t3.${addReviewers}\n\t\t\t\x3c/div\x3e\n\t\t\x3c/div\x3e\n\t\t\x3cdiv dojoAttachPoint\x3d"reviewerStackContainer" class\x3d\'mainSection\'\x3e\n\t\t\x3c/div\x3e\n\t\t\x3ctable cellspacing\x3d"10" dojoAttachPoint\x3d"page1Node"\x3e\n\t\t\t\x3ctr\x3e\n\t\t\t\t\x3ctd\x3e\x3clabel for\x3d"versionTitle"\x3e${title}:\x3c/label\x3e\x3c/td\x3e\n\t\t\t\t\x3ctd\x3e\x3cinput dojoAttachPoint\x3d"versionTitle"\x3e\x3c/input\x3e\x3c/td\x3e\n\t\t\t\t\x3ctd\x3e\x3cinput dojoAttachPoint\x3d"receiveEmail"\x3e\x3c/input\x3e\x3clabel class\x3d\'emailLabel\' for\x3d"receiveEmail"\x3e${notifyMe}\x3c/label\x3e\x3c/td\x3e\n\t\t\t\x3c/tr\x3e\n\t\t\t\x3ctr\x3e\n\t\t\t\t\x3ctd valign\x3d"top"\x3e\x3clabel for\x3d"descriptions"\x3e${description}:\x3c/label\x3e\x3c/td\x3e\n\t\t\t\t\x3ctd colspan\x3d"2"\x3e\x3cinput dojoAttachPoint\x3d"descriptions"\x3e\x3c/input\x3e\x3c/td\x3e\n\t\t\t\x3c/tr\x3e\n\t\t\t\x3ctr\x3e\n\t\t\t\t\x3ctd\x3e\x3clabel\x3e${windowSize}:\x3c/label\x3e\x3c/td\x3e\n\t\t\t\t\x3ctd colspan\x3d"2"\x3e\x3cinput dojoAttachPoint\x3d"desireWidth"\x3e\x3c/input\x3e\x3clabel\x3e*\x3c/label\x3e\x3cinput dojoAttachPoint\x3d"desireHeight"/\x3e\x3c/td\x3e\n\t\t\t\x3c/tr\x3e\n\t\t\t\x3ctr\x3e\n\t\t\t\t\x3ctd\x3e\x3clabel for\x3d"dueDate"\x3e${dueDate}:\x3c/label\x3e\x3c/td\x3e\n\t\t\t\t\x3ctd\x3e\x3cinput dojoAttachPoint\x3d"dueDate" /\x3e\x3c/td\x3e\n\t\t\t\t\x3ctd class\x3d"review-tips"\x3e\x3clabel\x3e${leaveBlank}\x3c/label\x3e\x3c/td\x3e\n\t\t\t\x3c/tr\x3e\n\t\t\x3c/table\x3e\n\t\t\n\t\t\x3ctable cellspacing\x3d"10" dojoAttachPoint\x3d"page2Node"\x3e\n\t\t\t\x3ctr\x3e\n\t\t\t\t\x3ctd\x3e${availableFiles}:\x3c/td\x3e\n\t\t\t\t\x3ctd\x3e\x3c/td\x3e\n\t\t\t\t\x3ctd\x3e${selectedFiles}:\x3c/td\x3e\n\t\t\t\x3c/tr\x3e\n\t\t\t\x3ctr\x3e\n\t\t\t\t\x3ctd\x3e\n\t\t\t\t\t\x3cdiv dojoAttachPoint\x3d"sourceTreeNode" class\x3d\'sourceTree\'\x3e\n\t\t\t\t\t\t\n\t\t\t\t\t\x3c/div\x3e\n\t\t\t\t\x3c/td\x3e\n\t\t\t\t\x3ctd\x3e\n\t\t\t\t\t\x3ca href\x3d"javascript:void(0);" dojoAttachEvent\x3d"onclick:addSelectFiles"\x3e\x3cimg src\x3d"app/davinci/review/resources/img/forward_nav.gif"/\x3e\x3c/a\x3e\n\t\t\t\t\x3c/td\x3e\n\t\t\t\t\x3ctd\x3e\n\t\t\t\t\t\x3cdiv dojoAttachPoint\x3d"targetTreeNode" class\x3d\'sourceTree\'\x3e\n\t\t\t\t\t\n\t\t\t\t\t\x3c/div\x3e\n\t\t\t\t\x3c/td\x3e\n\t\t\t\x3c/tr\x3e\n\t\t\x3c/table\x3e\n\t\t\n\t\t\x3ctable cellspacing\x3d"10" dojoAttachPoint\x3d"page3Node"\x3e\n\t\t\t\x3ctr valign\x3d"top"\x3e\n\t\t\t\t\x3ctd align\x3d"left" rowspan\x3d2\x3e\x3cdiv class\x3d\'reviewers\'\x3e${reviewers}:\x3c/div\x3e\x3c/td\x3e\n\t\t\t\t\x3ctd colspan\x3d2\x3e\x3cdiv dojoAttachPoint\x3d"userGrid" class\x3d\'reviewerList\'\x3e\x3c/div\x3e\x3c/td\x3e\n\t\t\t\x3c/tr\x3e\n\t\t\t\x3ctr\x3e\n\t\t\t\t\x3ctd class\x3d\'reviewerBox\'\x3e\n\t\t\t\t\t\x3cdiv dojoAttachPoint\x3d"addReviewerCombox"\x3e\x3c/div\x3e\n\t\t\t\t\x3c/td\x3e\n\t\t\t\t\x3ctd align\x3d"left"\x3e\x3cbutton dojoAttachPoint\x3d"addReviewerButton"\x3e\x3c/button\x3e\x3c/td\x3e\n\t\t\t\x3c/tr\x3e\n\t\t\x3c/table\x3e\n\t\x3c/div\x3e\n\n\t\t\x3cdiv class\x3d\'dijitDialogPaneActionBar dialogButtonContainerOverride\'\x3e\n\t\t\t\x3cdiv dojoAttachPoint\x3d"reviewMsg" class\x3d"reviewMsg"\x3e\x3c/div\x3e\n\t\t\t\x3ca class\x3d\'cancelButton\' href\x3d"javascript:void(0);" dojoAttachEvent\x3d"onclick:onClose"\x3e${buttonCancel}\x3c/a\x3e\n\t\t\t\x3cbutton class\x3d\'maqSecondaryButton\' dojoAttachPoint\x3d"saveDt"\x3e${saveAsDraft}\x3c/button\x3e\n\t\t\t\x3cbutton class\x3d\'maqSecondaryButton\' dojoAttachPoint\x3d"prev"\x3e\x26lt ${back}\x3c/button\x3e\n\t\t\t\x3cbutton class\x3d\'maqSecondaryButton\' dojoAttachPoint\x3d"next"\x3e${next} \x26gt\x3c/button\x3e\n\t\t\t\x3cbutton class\x3d\'maqPrimaryButton\' dojoAttachPoint\x3d"invite"\x3e${publishReview}\x3c/button\x3e\n\t\t\x3c/div\x3e\n\x3c/div\x3e',
"url:davinci/review/widgets/templates/MailFailureDialogContent.html":"\x3cdiv\x3e\n\x3cdiv class\x3d'mailFailureInfo'\x3e${inviteNotSent}\x3c/div\x3e\n\x3cdiv class\x3d'mailFailureExtraInfo'\x3e${mailFailureMsg}\x3c/div\x3e\n\x3cdiv class\x3d'mailFailureContent'\x3e${htmlContent}\x3c/div\x3e\n\x3c/div\x3e\n"}});
define("davinci/review/widgets/PublishWizard","dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dijit/layout/StackContainer dijit/layout/ContentPane dijit/form/SimpleTextarea dijit/form/NumberTextBox dijit/form/ValidationTextBox dijit/form/DateTextBox dijit/form/Button dijit/form/ComboBox dojo/data/ItemFileWriteStore dijit/form/CheckBox dojox/grid/DataGrid dojox/data/QueryReadStore dojox/widget/Toaster dojox/validate/regexp dojo/_base/xhr dojo/string dojo/fx dojo/date/stamp dijit/Tree dojo/Deferred dojo/promise/all system/resource davinci/Runtime davinci/Workbench davinci/model/resource/Folder davinci/model/resource/File davinci/review/model/resource/Empty davinci/review/model/resource/root dijit/tree/TreeStoreModel davinci/review/model/store/GeneralReviewReadStore dojo/i18n!./nls/widgets dojo/i18n!dijit/nls/common dojo/text!./templates/PublishWizard.html dojo/text!./templates/MailFailureDialogContent.html".split(" "),function(k,
v,w,T,x,l,y,n,z,A,g,B,C,D,E,F,G,H,p,q,U,I,r,J,V,K,h,s,L,M,N,W,t,u,d,O,P,Q){var R=k(dijit._TreeNode,{postCreate:function(){this.inherited(arguments);var a=dojo.create("img",{src:"app/dojo/resources/blank.gif","class":"deleteImg"});dojo.connect(a,"onclick",this,dojo.hitch(this,function(){dojo.publish("/davinci/review/deleteReviewFile",[this.item])}));dojo.place(a,this.rowNode,"first");dojo.style(this.rowNode,{width:"99%"});dojo.style(this.containerNode,{display:"block"})}}),S=k(r,{_createTreeNode:function(a){return new R(a)}});
return k("davinci.review.widgets.PublishWizard",[v,w],{templateString:P,postMixInProperties:function(){this.inherited(arguments);dojo.mixin(this,d);dojo.mixin(this,O)},postCreate:function(){var a=this.reviewerStackContainer=new x({},this.reviewerStackContainer),b=this.page1=new l({style:"overflow:hidden;"}),c=this.page2=new l({style:"overflow:hidden;"}),f=this.page3=new l({style:"overflow:hidden;"});this.reviewerStackContainer.addChild(b);this.reviewerStackContainer.addChild(c);this.reviewerStackContainer.addChild(f);
this._initPage1();this._initPage2();this._initPage3();this._initButtons();dojo.place(this.page1Node,b.domNode);dojo.place(this.page2Node,c.domNode);dojo.place(this.page3Node,f.domNode);a.startup();this._subs=[dojo.subscribe(a.id+"-selectChild",dojo.hitch(this,this._onPageSelected)),dojo.subscribe("/davinci/review/publish/valueChanged",dojo.hitch(this,this.updateSubmit)),dojo.subscribe("/davinci/review/deleteReviewFile",dojo.hitch(this,this.delFiles)),dojo.subscribe("/davinci/review/deleteReviewer",
dojo.hitch(this,this.delRow))]},_initPage1:function(){this.versionTitle=new z({onChange:this._onValueChange,required:!0},this.versionTitle);this.receiveEmail=new D({checked:!0},this.receiveEmail);this.descriptions=new y({style:"width:460px;height:100px;font-family:Verdana, Arial, Helvetica, sans-serif;font-size:100%;"},this.descriptions);this.desireWidth=new n({constraints:{min:0,places:0},value:1024,style:"width:85px"},this.desireWidth);this.desireHeight=new n({constraints:{min:0,places:0},value:768,
style:"width:85px"},this.desireHeight);var a=new Date;this.dueDate=new A({onChange:this._onValueChange,type:"text",constraints:{min:new Date(a.getFullYear(),a.getMonth(),a.getDate())}},this.dueDate)},_initPage2:function(){this.fileIndex=1;this.reviewFiles=[];var a=this.sourceTreeModel=new t({deferItemLoadingUntilExpand:!0,store:new u({root:new L(s.getProject(),null),getLabel:function(a){var c=a.getName();a.link&&(c=c+"  ["+a.link+"]");return c}})}),a=this.sourceTree=new r({id:"reviewWizardSourceTree",
persist:!1,showRoot:!1,model:a,labelAttr:"name",getIconClass:dojo.hitch(this,this._getIconClass),isMultiSelect:!0,onDblClick:dojo.hitch(this,function(a){this.addFiles([a])}),transforms:[function(a){return a.sort(function(a,b){a=a.name.toLowerCase();b=b.name.toLowerCase();return a<b?-1:a>b?1:0})}]});this.sourceTreeNode.appendChild(a.domNode);a.startup();a=this.targetTreeModel=new t({store:new u({root:new N,getLabel:function(a){var c=a.getName();a.link&&(c=c+"  ["+a.link+"]");return c}})});a=this.targetTree=
new S({id:"reviewWizardTargetTree",showRoot:!1,model:a,labelAttr:"name",getIconClass:dojo.hitch(this,this._getIconClass),isMultiSelect:!0});this.targetTreeNode.appendChild(a.domNode);a.startup()},_initPage3:function(){var a=function(a){this.photoRepositoryUrl||(this.photoRepositoryUrl=h.serverJSONRequest({url:"cmd/getBluePageInfo",handleAs:"text",content:{type:"photo"},sync:!0}));if(""===this.photoRepositoryUrl||"not-implemented"==this.photoRepositoryUrl)this.photoRepositoryUrl="app/davinci/review/resources/img/profileNoPhoto.gif?";
return'\x3cimg src\x3d"'+this.photoRepositoryUrl+a+'" width\x3d"35px" height\x3d"35px" alt\x3d"User Photo"\x3e\x3c/img\x3e'}.bind(this),a=[{cells:[{name:d.user,field:"email",formatter:a,width:"70px",styles:"text-align: center;"},{name:d.emailAddress,field:"displayName",width:"320px"},{name:d.action,field:"action",formatter:function(a){return'\x3ca href\x3d"javascript:dojo.publish(\'/davinci/review/deleteReviewer\',[])"\x3e\x3cimg class\x3d"delImg" src\x3d"app/davinci/review/resources/img/del.gif"/\x3e\x3c/a\x3e'},
width:"70px",styles:"text-align: center;"}]}],b={identifier:"email",label:"name",items:[]};this.userData=b.items;var c=new C({data:b});this.jsonStore=c;this.grid=a=new E({elasticView:"1",store:c,structure:a,style:"height:100%;width:100%;",canSort:function(a){return 1==a?!1:!0},canResize:function(){return!1},delRow:function(a){this.removeSelectedRows();c.save()}});this.userGrid.appendChild(a.domNode);a.startup();this.addReviewerButton=new g({disabled:!0,onClick:dojo.hitch(this,this.addReviewer),label:"\x3cdiv style\x3d'width:75px;height:10px;margin:-6px 0 0 0'\x3e"+
d.add+"\x3c/div\x3e"},this.addReviewerButton);a=new F({url:"cmd/getBluePageInfo",fetch:function(a){var b=a.query.displayName,b=b.substring(0,b.length-1);a.serverQuery={searchname:b};return this.inherited("fetch",arguments)}});this.addReviewerCombox=new B({regExpGen:dojo.hitch(this,this._emailAddress),required:!0,store:a,searchAttr:"displayName",name:"displayName",autoComplete:!1,hasDownArrow:!1,highlightMatch:"all",style:"width:220px",onChange:dojo.hitch(this,this._reviewerComboxValueChanged),onKeyUp:dojo.hitch(this,
this._updateAddButton),pageSize:10,searchDelay:500,placeHolder:d.enterNameOrEmail},this.addReviewerCombox)},_emailAddress:function(a){if(this.addReviewerCombox.item)return".*";a="object"==typeof a?a:{};"boolean"!=typeof a.allowCruft&&(a.allowCruft=!1);a.allowPort=!1;var b="([!#-'*+\\-\\/-9\x3d?A-Z^-~]+[.])*[!#-'*+\\-\\/-9\x3d?A-Z^-~]+@"+H.host(a);a.allowCruft&&(b="\x3c?(mailto\\:)?"+b+"\x3e?");return b},_initButtons:function(){this.invite=new g({disabled:!0,onClick:dojo.hitch(this,function(){this.publish()})},
this.invite);this.next=new g({onClick:dojo.hitch(this,function(){this.reviewerStackContainer.forward()})},this.next);this.prev=new g({onClick:dojo.hitch(this,function(){this.reviewerStackContainer.back()})},this.prev);this.saveDt=new g({onClick:dojo.hitch(this,function(){this.publish(!0)})},this.saveDt)},_reviewerComboxValueChanged:function(){this.addReviewerCombox.item&&this.addReviewer()},_updateAddButton:function(a){var b=this.addReviewerCombox.isValid();this.addReviewerButton.set("disabled",!b);
13==a.keyCode&&b&&this.addReviewer()},delRow:function(){this.grid.delRow();dojo.publish("/davinci/review/publish/valueChanged")},addReviewer:function(){var a=this.addReviewerCombox.item,b,c,f;a?(b=this.addReviewerCombox.value.split(",").join(""),c=a.i.emailaddress,f=a.i.name,f=f.split(",").join("")):f=c=b=this.addReviewerCombox.get("value");this.jsonStore.fetchItemByIdentity({identity:c,onItem:function(b){a=b}});var e=this.grid;a?(b=e.getItemIndex(a),e.scrollToRow(b),e=e.getRowNode(b),dojo.fx.chain([dojo.fadeOut({node:e,
duration:300}),dojo.fadeIn({node:e,duration:700}),dojo.fadeOut({node:e,duration:300}),dojo.fadeIn({node:e,duration:700})]).play(),e.removeAttribute("style")):(this.jsonStore.newItem({name:f,email:c,displayName:b}),e.scrollToRow(e.get("rowCount")),this.addReviewerCombox.item=null,this.addReviewerCombox.reset(),this.addReviewerButton.set("disabled",!0),dojo.publish("/davinci/review/publish/valueChanged"))},_onValueChange:function(){dojo.publish("/davinci/review/publish/valueChanged")},_onPageSelected:function(a){this.prev.set("disabled",
a.isFirstChild);this.next.set("disabled",a.isLastChild);dojo.removeClass(this.navPage1,"current");dojo.removeClass(this.navPage2,"current");dojo.removeClass(this.navPage3,"current");a==this.page1&&dojo.addClass(this.navPage1,"current");a==this.page2&&dojo.addClass(this.navPage2,"current");a==this.page3&&dojo.addClass(this.navPage3,"current")},updateSubmit:function(){var a=this.versionTitle.isValid()&&this.dueDate.isValid(),b=this.reviewFiles&&0<this.reviewFiles.length,c=0<this.userData.length;dojo.removeClass(this.navPage1Icon,
a?"todo":"done");dojo.addClass(this.navPage1Icon,a?"done":"todo");dojo.removeClass(this.navPage2Icon,b?"todo":"done");dojo.addClass(this.navPage2Icon,b?"done":"todo");dojo.removeClass(this.navPage3Icon,c?"todo":"done");dojo.addClass(this.navPage3Icon,c?"done":"todo");this.invite.set("disabled",!(a&&b&&c));a="";c||(a=d.noReviewersSelected);b||(a=d.noFilesSelected);this.dueDate.isValid()||(a=d.dueDateIncorrect);this.versionTitle.isValid()||(a=d.titleRequired);this.reviewMsg.innerHTML=a},select:function(a){a=
a.target;var b=this.reviewerStackContainer;a==this.navPage1||a==this.navPage1Icon?b.selectChild(this.page1,!0):a==this.navPage2||a==this.navPage2Icon?b.selectChild(this.page2,!0):(a==this.navPage3||a==this.navPage3Icon)&&b.selectChild(this.page3,!0)},update:function(){var a=this.targetTreeModel;a.onChildrenChange(a.root,a.root.children)},containReviewFile:function(a){return(this.reviewFiles||[]).some(function(b){return isNaN(a)?b==a:b.index==a})},getChildrenFiles:function(a){var b=this.reviewFiles||
[],c=this.targetTreeModel;"File"==a.elementType?this.containReviewFile(a)||(a.index=this.fileIndex++,b.push(a),b=new M(a.name,c.root),b.index=a.index,c.root.children.push(b)):"Folder"==a.elementType&&a.getChildren(function(a){dojo.forEach(a,dojo.hitch(this,function(a){"File"==a.elementType&&this.getChildrenFiles(a)}.bind(this)))}.bind(this))},addSelectFiles:function(){var a=this.sourceTree.get("selectedItems");this.addFiles(a)},addFiles:function(a){var b=this.sourceTree.get("selectedItems");a&&(b=
a);dojo.forEach(b,this.getChildrenFiles,this);this.update();dojo.publish("/davinci/review/publish/valueChanged")},delFiles:function(a){var b=this.reviewFiles,c=this.targetTree.get("selectedItems");a&&(c=[a]);dojo.forEach(c,dojo.hitch(this,function(a){if(a.index){var c,d;for(d=0;d<b.length;d++)if(a.index==b[d].index){c=b[d];b.splice(d,1);break}if(c){var m=a.parent.children;for(d=0;d<m.length;d++)if(a==m[d]){a.parent.children.splice(d,1);break}this.update(c)}}}));dojo.publish("/davinci/review/publish/valueChanged")},
_getIconClass:function(a,b){if("Folder"==a.elementType)return b?"dijitFolderOpened":"dijitFolderClosed";if("File"==a.elementType){var c,d=a.getExtension(),e=h.getExtension("davinci.fileType",function(a){return a.extension==d});e&&(c=e.iconClass);return c||"dijitLeaf"}return"dijitLeaf"},initData:function(a,b){var c=new J;this.node=a;this.isRestart=b;a||p.get({url:"cmd/getLatestVersionId"}).then(function(a){this.versionTitle.set("value",dojo.string.substitute(d.defaultReviewTitle,[a]))}.bind(this));
if(a){var f=a.name;b&&(f+=" (R)");this.versionTitle.set("value",f);this.isRestart||this.dueDate.set("value","infinite"==a.dueDate?new Date(""):a.dueDate);this.desireWidth.set("value",0===a.width?"":a.width);this.desireHeight.set("value",0===a.height?"":a.height);a.description&&this.descriptions.set("value",a.description);this.receiveEmail.set("value",a.receiveEmail);a.getChildren(function(b){dojo.forEach(b,function(a){a=K.findResource(a.name);null!=a&&this.addFiles([a])}.bind(this));for(b=0;b<a.reviewers.length;b++)if(a.reviewers[b].email!=
a.designerEmail){var d=h.getUserDisplayNamePlusEmail({email:a.reviewers[b].email,userId:a.reviewers[b].name});this.jsonStore.newItem({name:a.reviewers[b].name,email:a.reviewers[b].email,displayName:d})}c.resolve()}.bind(this))}else c.resolve();return c},publish:function(a){var b=this.userData.map(function(a){return a.email}).join(","),c=this.descriptions.value,f=this.versionTitle.value,e=this.dueDate.get("value"),e=e?I.toISOString(e,{zulu:!0}):"infinite",g=this.desireWidth.value||0,m=this.desireHeight.value||
0,k=dojo.map(this.reviewFiles,function(a){a=a.getPath();2<a.length&&0==a.indexOf("./")&&(a=a.substring(2));return a}),l="on"==this.receiveEmail.get("value")?"true":"false",b={isUpdate:this.node&&!this.isRestart,isRestart:this.isRestart,vTime:this.node?this.node.timeStamp:null,emails:b,message:c,versionTitle:f,resources:k,desireWidth:g,desireHeight:m,savingDraft:a,dueDate:e,receiveEmail:l};h.currentEditor&&(h.currentEditor.getContext&&h.currentEditor.getContext().getPreference("zazl"))&&(b.zazl=!0);
b=dojo.objectToQuery(b);p.post({url:"cmd/publish?"+b,handleAs:"json"}).then(function(b){"undefined"==typeof hasToaster&&(new G({position:"br-left",duration:4E3,messageTopic:"/davinci/review/resourceChanged"}),hasToaster=!0);0<b.length&&(b=b[0],"OK"==b.result&&(a?dojo.publish("/davinci/review/resourceChanged",[{message:d.draftSaved,type:"message"},"draft",this.node]):b.emailResult&&("OK"==b.emailResult?dojo.publish("/davinci/review/resourceChanged",[{message:d.inviteSuccessful,type:"message"},"create",
this.node]):(b=q.substitute(Q,{htmlContent:b.emailResult,inviteNotSent:d.inviteNotSent,mailFailureMsg:d.mailFailureMsg}),dojo.publish("/davinci/review/resourceChanged",[{message:d.inviteFailed,type:"warning"},"create",this.node]),s.showMessage(d.warning,b)))))}.bind(this)).otherwise(function(a){var b=a.responseText,b=b.substring(b.indexOf("\x3ctitle\x3e")+7,b.indexOf("\x3c/title\x3e"));h.handleError(q.substitute(d.errorPublish,[a,b]))});this.onClose()},onClose:function(){},destroy:function(){this.inherited(arguments);
this._subs.forEach(dojo.unsubscribe);delete this._subs;this.sourceTree.destroyRecursive();this.targetTree.destroyRecursive()}})});
//# sourceMappingURL=PublishWizard.js.map