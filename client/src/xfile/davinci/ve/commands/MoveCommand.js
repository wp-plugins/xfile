//>>built
define("davinci/ve/commands/MoveCommand","dojo/_base/declare dojo/dom-geometry davinci/ve/widget davinci/ve/States davinci/ve/utils/StyleArray davinci/ve/utils/GeomUtils".split(" "),function(k,l,g,h,d,m){return k("davinci.ve.commands.MoveCommand",null,{name:"move",constructor:function(b,a,c,e,f,d,g){this._id=b?b.id:void 0;this._context=b.getContext();this._newBox={l:a,t:c};this._commandForXYDeltas=e;this._oldBox=f;this._applyToStateIndex=!d||"Normal"==d||"undefined"==d?"undefined":d;this._disableSnapping=
g},execute:function(){if(this._id){var b=g.byId(this._id);if(b&&b.domNode){var a=this._context;if(!this._oldBox){var c=b.getMarginBox();this._oldBox={l:c.l,t:c.t,w:c.w,h:c.h}}if(b.domNode.offsetParent&&dojo.position(b.domNode.offsetParent,!0)){this._commandForXYDeltas?(this._newBox.l=this._oldBox.l+this._commandForXYDeltas._deltaX,this._newBox.t=this._oldBox.t+this._commandForXYDeltas._deltaY):(!this._disableSnapping&&(a&&a._snapX)&&(c=this._oldBox.w,"left"==a._snapX.typeRefObj?this._newBox.l=a._snapX.x:
c&&"right"==a._snapX.typeRefObj?this._newBox.l=a._snapX.x-c:c&&"center"==a._snapX.typeRefObj&&(this._newBox.l=a._snapX.x-c/2)),!this._disableSnapping&&(a&&a._snapY)&&(c=this._oldBox.h,"top"==a._snapY.typeRefObj?this._newBox.t=a._snapY.y:c&&"bottom"==a._snapY.typeRefObj?this._newBox.t=a._snapY.y-c:c&&"middle"==a._snapY.typeRefObj&&(this._newBox.t=a._snapY.y-c/2)));this._deltaX=this._newBox.l-this._oldBox.l;this._deltaY=this._newBox.t-this._oldBox.t;var c=m.getBorderBoxPageCoords(b.domNode.offsetParent),
e=l.getBorderExtents(b.domNode.offsetParent),f=[{left:this._newBox.l-c.l-e.l+"px"},{top:this._newBox.t-c.t-e.t+"px"}],a=b.getStyleValuesAllStates();this._oldStyleValuesAllStates=dojo.clone(a);this._oldBox&&(this._oldStyleValuesAllStates[this._applyToStateIndex]=d.mergeStyleArrays(this._oldStyleValuesAllStates[this._applyToStateIndex],[{left:this._oldBox.l-c.l-e.l+"px"},{top:this._oldBox.t-c.t-e.t+"px"}]));a[this._applyToStateIndex]=a[this._applyToStateIndex]?d.mergeStyleArrays(a[this._applyToStateIndex],
f):f;b.setStyleValuesAllStates(a);c=h.getStatesListCurrent(b.domNode);e=d.mergeStyleArrays([],a.undefined);for(f=0;f<c.length;f++)a[c[f]]&&(e=d.mergeStyleArrays(e,a[c[f]]));b.setStyleValuesCanvas(e);b.setStyleValuesModel(a.undefined);b.refresh();h.resetState(b.domNode);dojo.publish("/davinci/ui/widgetPropertiesChanged",[[b]])}}}},undo:function(){if(this._id){var b=g.byId(this._id);if(b){var a=this._oldStyleValuesAllStates,c=this._applyToStateIndex;b.setStyleValuesAllStates(a);a=d.mergeStyleArrays(a.undefined,
a[c]);b.setStyleValuesCanvas(a);b.setStyleValuesModel(this._oldStyleValuesAllStates.undefined);b.refresh();davinci.ve.states.resetState(b.domNode);dojo.publish("/davinci/ui/widgetPropertiesChanged",[[b]])}}}})});
//# sourceMappingURL=MoveCommand.js.map