//>>built
define("davinci/review/drawing/tools/scaffolds/_ScaffoldCommon",["dojo/_base/declare"],function(d){return d("davinci.review.drawing.tools.scaffolds._ScaffoldCommon",null,{constructor:function(a){this.surface=a},createShape:function(a,b,c){this.shape.render()},transformShape:function(a,b){this.shape&&this.shape.render()},wrapShape:function(a,b,c){this.shape=a;b||(this._clickPoint=c,this._onShapeMouseDown())},moveShape:function(a,b){var c=this.shape;c.x1+=a;c.y1+=b;c.x2+=a;c.y2+=b;c.render();this.wrapShape(c,
!0)},removeShape:function(){this.surface.removeShape(this.shape);this.destroy()},onHandlerMouseMove:function(a){this.shape.render();this.wrapShape(this.shape,!0)},destroy:function(){dojo.forEach(this._evtConns,dojo.disconnect);dojo.forEach(this._evtSubs,dojo.unsubscribe);this.activeHandler=this.shape=this.surface=null},onHandlerMouseDown:function(a){var b=this.shape;this.activeHandler=a.target;switch(this.activeHandler.position){case "nw":this.anchorPoint={x:b.x2,y:b.y2};break;case "ne":this.anchorPoint=
{x:b.x1,y:b.y2};break;case "se":this.anchorPoint={x:b.x1,y:b.y1};break;case "sw":this.anchorPoint={x:b.x2,y:b.y1}}dojo.stopEvent(a);this._mouseMoveHandler=dojo.connect(this.surface.domNode,"mousemove",this,"onHandlerMouseMove");this._mouseUpHandler=dojo.connect(this.surface.domNode,"mouseup",this,"_onHandlerMouseUp")},_onHandlerMouseUp:function(a){dojo.disconnect(this._mouseMoveHandler);dojo.disconnect(this._mouseUpHandler)},_onShapeMouseDown:function(){this._mouseMoveHandler=dojo.connect(this.surface.domNode,
"mousemove",this,"_onShapeMouseMove");this._mouseUpHandler=dojo.connect(this.surface.domNode,"mouseup",this,"_onShapeMouseUp");this._evtConns.push(dojo.connect(this.surface.domNode,"keydown",this,"_onShapeKeyDown"))},_onShapeMouseMove:function(a){var b=a.pageX-this._clickPoint.x,c=a.pageY-this._clickPoint.y;this._clickPoint.x=a.pageX;this._clickPoint.y=a.pageY;this.moveShape(b,c)},_onShapeMouseUp:function(a){dojo.disconnect(this._mouseMoveHandler);dojo.disconnect(this._mouseUpHandler)},_onShapeKeyDown:function(a){if(!this.shape.editable)switch(dojo.stopEvent(a),
a.keyCode){case dojo.keys.ESCAPE:this.destroy();break;case dojo.keys.DELETE:case dojo.keys.BACKSPACE:this.removeShape();break;case dojo.keys.LEFT_ARROW:this.moveShape(-2,0);break;case dojo.keys.UP_ARROW:this.moveShape(0,-2);break;case dojo.keys.RIGHT_ARROW:this.moveShape(2,0);break;case dojo.keys.DOWN_ARROW:this.moveShape(0,2)}},_createHandler:function(a){var b=dojo.create("div");this.handlerRadius=3;dojo.style(b,{position:"absolute",padding:"0px",margin:"0px",border:"1px solid black",backgroundColor:"white",
width:2*(this.handlerRadius-1)+"px",height:2*(this.handlerRadius-1)+"px",MozBorderRadius:this.handlerRadius+"px",WebkitBorderRadius:this.handlerRadius+"px",borderRadius:this.handlerRadius+"px",cursor:a+"-resize",zIndex:1000256});b.position=a;return b}})});
//# sourceMappingURL=_ScaffoldCommon.js.map