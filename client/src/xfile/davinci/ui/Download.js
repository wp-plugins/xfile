//>>built
require({cache:{"url:davinci/ui/templates/download.html":'\x3cdiv class\x3d\'downloadDialog\'\x3e\t \n\t\x3cdiv class\x3d"dijitDialogPaneContentArea"\x3e\n\t\t\x3cdiv style\x3d"margin-bottom: 20px"\x3e\n\t\t  ${fileName}: \x3cinput data-dojo-type\x3d\'dijit/form/ValidationTextBox\' type\x3d"text" maxLength\x3d\'${_fileNameMaxLength}\' data-dojo-attach-point\x3d"__fileName" value\x3d\'${_projectName}.zip\' data-dojo-props\x3d"regExp:\'${_fileNameValidationRegExp}\', required:true, invalidMessage:\'${invalidDownloadFileName}\'"\x3e\x3c/input\x3e\n\t\t\x3c/div\x3e\n\t\t\n\t\t\x3cdiv data-dojo-attach-point\x3d"_selectionDiv"\x3e\x3c/div\x3e\n\t\t\x3cdiv data-dojo-attach-point\x3d"_tableDiv"\x3e\x3c/div\x3e\n\n\t\t\x3cdiv style\x3d"margin-top: 8px"\x3e\n\t\t  Select: \x3ca href\x3d"javascript:;" data-dojo-attach-event\x3d"onclick: _selectAll"\x3e${selectAll}\x3c/a\x3e / \x3ca href\x3d"javascript:;" data-dojo-attach-event\x3d"onclick: _selectNone"\x3e${selectNone}\x3c/a\x3e\n\t\t\x3c/div\x3e\n\n\t\t\x3cdiv style\x3d"margin-top: 20px"\x3e\n\t\t\t\x3cinput data-dojo-type\x3d\'dijit/form/CheckBox\' type\x3d"text" data-dojo-attach-point\x3d"__fullSource" data-dojo-props\x3d""\x3e\x3c/input\x3e\x3cspan style\x3d\'padding-left: 3px;\'\x3e${downloadFullSource}\x3c/span\x3e\n\t\t\t\x3cbr\x3e\n\t\t\t\x3cinput data-dojo-type\x3d\'dijit/form/CheckBox\' type\x3d"text" data-dojo-attach-point\x3d"__optimize" data-dojo-props\x3d""\x3e\x3c/input\x3e\x3cspan style\x3d\'padding-left: 3px;\'\x3e${optimizeOption}\x3c/span\x3e\n\t\t\x3c/div\x3e\n  \x3c/div\x3e\n\t\x3cdiv class\x3d"dijitDialogPaneActionBar"\x3e\n\t\t\x3cbutton data-dojo-type\x3d\'dijit/form/Button\' data-dojo-attach-point\x3d"_okButton" data-dojo-attach-event\x3d\'onClick:okButton\' label\x3d\'${downloadButtonLabel}\' class\x3d"maqPrimaryButton" type\x3d"submit"\x3e\x3c/button\x3e\n\t\t\x3cbutton data-dojo-type\x3d\'dijit/form/Button\' data-dojo-attach-event\x3d\'onClick:cancelButton\' label\x3d\'${buttonCancel}\' class\x3d"maqSecondaryButton"\x3e\x3c/button\x3e\n\t\x3c/div\x3e\n\x3c/div\x3e'}});
define("davinci/ui/Download","dojo/_base/declare dijit/_TemplatedMixin dijit/_WidgetBase dijit/_WidgetsInTemplateMixin davinci/library system/resource dojo/promise/all dojo/parser davinci/Workbench davinci/ve/RebaseDownload dojo/i18n!./nls/ui dojo/i18n!dijit/nls/common dojo/text!./templates/download.html davinci/Theme dijit/form/Button dijit/form/ValidationTextBox dijit/form/TextBox".split(" "),function(h,k,l,m,n,f,p,q,e,r,g,s,t,u){return h([l,k,m],{templateString:t,_fileNameValidationRegExp:"[a-zA-z0-9_.]+",
_fileNameMaxLength:50,postMixInProperties:function(){this._projectName=e.getProject();dojo.mixin(this,g);dojo.mixin(this,s);this.inherited(arguments)},buildRendering:function(){this.inherited(arguments);this._buildUITable()},_buildUITable:function(){this._handles=[];this._userLibs=n.getUserLibs(this.getRoot());var a=[dojo.replace("\x3ctable cellspacing\x3d'0' cellpadding\x3d'0' width\x3d'100%' class\x3d'dwnloadLibTable'\x3e\x3ctr\x3e\x3ctd class\x3d'header'\x3e{library}\x3c/td\x3e\x3ctd class\x3d'header'\x3e{version}\x3c/td\x3e\x3ctd class\x3d'header'\x3e{include}\x3cbr\x3e{source}\x3c/td\x3e\x3ctd class\x3d'header'\x3e{baseLocation}\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd colspan\x3d'4'\x3e\x3chr\x3e\x3c/hr\x3e\x3c/td\x3e\x3c/tr\x3e",
g)];this.libraries={};this._userLibs.forEach(function(b,c){b.initRoot=this._getLibRoot(b.id,b.version);var d=b.id;b.initRoot&&(a.push("\x3ctr libPath\x3d'"+c+"'"),b.required&&a.push(" style\x3d'display:none'"),a.push("\x3e"),a=a.concat(["\x3ctd class\x3d'columna'\x3e"+d+"\x3c/td\x3e","\x3ctd class\x3d'columnb'\x3e"+b.version+"\x3c/td\x3e","\x3ctd class\x3d'columnc'\x3e\x3cinput type\x3d'checkbox' data-dojo-type\x3d'dijit/form/CheckBox' checked\x3e\x3c/input\x3e\x3c/td\x3e","\x3ctd class\x3d'columnd'\x3e\x3cinput type\x3d'text' data-dojo-type\x3d'dijit/form/TextBox' value\x3d'"+
b.initRoot+"'\x3e\x3c/input\x3e\x3c/td\x3e","\x3c/tr\x3e"]))},this);a.push("\x3c/table\x3e");dojo.place(a.join(""),this._tableDiv);q.parse(this._tableDiv)},_getLibRoot:function(a,b){var c=void 0;this._userLibs.some(function(d){if(d.id==a&&d.version==b)return c=d.root,!0});return c},_getLibs:function(){return dojo.query("tr[libPath]",this.domNode).map(function(a){var b=dijit.byNode(dojo.query(".dijitTextBox",a)[0]),c=dijit.byNode(dojo.query(".dijitCheckBox",a)[0]);a=parseInt(dojo.attr(a,"libPath"));
c=c.get("checked");b=b.get("value")||this._userLibs[a].root;return{id:this._userLibs[a].id,version:this._userLibs[a].version,root:b,includeSrc:c}},this)},getRoot:function(){if(e.singleProjectMode())return e.getProject()},_getResources:function(){return[e.getProject()]},_rewriteUrls:function(){var a=[];this._getResources().forEach(function(b){b=f.findResource(b);"Folder"==b.elementType?a=a.concat(f.findResource("*.html",!0,b,!0)):"html"==b.extension&&a.push(b)});var b=new r(this._getLibs()),c=a.filter(function(a){return!u.isThemeHTML(a)}).map(function(a){return b.rebuildSource(a.getContentSync(),
a).then(function(b){a.setContents(b,!0)})});return p(c)},_select:function(a){dojo.query("tr[libPath]",this.domNode).forEach(function(b){(b=dijit.byNode(dojo.query(".dijitCheckBox",b)[0]))&&b.set("checked",a)});return!1},_selectAll:function(){this._select(!0)},_selectNone:function(){this._select(!1)},okButton:function(){if(this.__fileName.isValid()){var a=dojo.attr(this.__fileName,"value");".zip"!=a.slice(-4)&&(a+=".zip");this._rewriteUrls().then(function(){var b=this._getLibs().filter(function(a){return a.includeSrc}),
c={};this.__optimize&&this.__optimize.getValue()&&(c.build="1");this.__fullSource&&this.__fullSource.getValue()&&(c.fullsource="1");setTimeout(function(){f.download(this._getResources(),a,this.getRoot(),b,c)}.bind(this),300)}.bind(this))}},cancelButton:function(){this.cancel=!0;this.onClose()}})});
//# sourceMappingURL=Download.js.map